
# Введение

Раньше разработчики создавали Cron-записи для каждой запланированной задачи. И это была проблема. Ваш задачи не находились в системе контроля версий, и вы должны были заходить через SSH на свой сервер, чтобы добавить или изменить Cron-записи. Планировщик команд Laravel позволяет вам гибко и выразительно определить планирование своих команд в самом Laravel. И для этого на вашем сервере необходима только одна Cron-запись.

Ваш планировщик задач определён в методе schedule() файла app/Console/Kernel.php. Чтобы быстро начать, там уже есть простой пример с методом. Вы можете добавить столько запланированных задач к объекту Schedule, сколько захотите.

# Запуск планировщика

При использовании планировщика, вам нужно только добавить следующую запись Cron на ваш сервер. Если вы не знаете, как добавить Cron записи на сервер, рассмотрите вопрос об использовании внешних услуг хостинга, таких как Laravel Forge, который может управлять Cron-записями:

```
* * * * * php /path/to/artisan schedule:run >> /dev/null 2>&1
```
Этот Cron будет запускать планировщик команд Laravel каждую минуту. Когда выполняется команда `schedule:run` Laravel обрабатывает ваши запланированные задачи и запускает только те, которые должен.

# Определение планировщика

Вы можете определить все свои запланированные задачи в методе schedule() класса App\Console\Kernel. Для начала давайте посмотрим на пример планирования задачи. В этом примере мы запланируем закрытие `Closure`, которое будет вызываться каждый день в полночь. В момент закрытия `Closure` мы выполним запрос БД, чтобы очистить таблицу:

```php
<?php

namespace App\Console;

use DB;
use Illuminate\Console\Scheduling\Schedule;
use Illuminate\Foundation\Console\Kernel as ConsoleKernel;

class Kernel extends ConsoleKernel
{
    /**
     * Artisan-команды вашего приложения.
     *
     * @var array
     */
    protected $commands = [
        \App\Console\Commands\Inspire::class,
    ];

    /**
     * Определяем планировщик команд приложения.
     *
     * @param  \Illuminate\Console\Scheduling\Schedule  $schedule
     * @return void
     */
    protected function schedule(Schedule $schedule)
    {
        $schedule->call(function () {
            DB::table('recent_users')->delete();
        })->daily();
    }
}
```

Помимио планирования вызова Closure вы можете также запланировать Artisan-команды и команды операционной системы. Например, чтобы запланировать Artisan-команду, вы можете использовать метод command() или класс:
```php
$schedule->command('emails:send --force')->daily();
```

```php
$schedule->command(EmailsCommand::class, ['--force'])->daily();
```

Команда `exec()` может быть использована для обращения к операционной системе:
```php
$schedule->exec('node /home/forge/script.js')->daily();
```

# Настройки частоты планировщика
Конечно, существует множество вариантов запуска планировщика, которые вы можете назначить для своей задачи:

Метод							| Описание                        
------------------|-----------------------------
`->cron('* * * * * *');`| Запускать задачу по пользовательскому расписанию                   
`->everyMinute();`| Запускать задачу каждую минуту           
`->everyFiveMinutes();`      | Запускать задачу каждые 5 минут                   
`->everyTenMinutes();  `     | Запускать задачу каждые 10 минут            
`->everyThirtyMinutes(); `      | Запускать задачу каждые 30 минут        
`->hourly();` | Запускать задачу каждый час            
`->daily(); `   | Запускать задачу каждый день в полночь   
`->dailyAt('13:00');`    | Запускать задачу каждый день в 13:00
`->twiceDaily(1, 13);`    | Запускать задачу каждый день в 1:00 и 13:00
`->weekly();`   | Запускать задачу каждую неделю
`->monthly();`| Запускать задачу каждый месяц
`->monthlyOn(4, '15:00');`| Запускать задачу каждый месяц 4 числа в 15:00
`->quarterly();`| Запускать задачу каждый квартал
`->yearly();`| Запускать задачу каждый год
`->timezone('America/New_York');`| Установить часовой пояс

